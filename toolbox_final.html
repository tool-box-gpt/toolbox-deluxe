
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Toolbox Deluxe</title>
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: #eee;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    h1 { text-align: center; color: #ff6600; }
    textarea, input, button, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      font-size: 14px;
      border-radius: 6px;
      border: none;
      box-sizing: border-box;
    }
    input, textarea, select {
      background: #1f1f1f;
      color: #fff;
    }
    button {
      background: #ff6600;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #e65c00;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid #333;
      background: #fff;
      margin-top: 20px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #1f1f1f;
      padding: 10px;
      margin: 5px 0;
      border-radius: 6px;
      cursor: pointer;
      border: 1px solid #333;
    }
    li:hover {
      background: #2a2a2a;
    }
    .drop-zone {
      border: 2px dashed #555;
      border-radius: 10px;
      padding: 30px;
      text-align: center;
      color: #888;
      margin: 20px 0;
    }
    .drop-zone.dragover {
      background: #1a1a1a;
      border-color: #ff6600;
      color: #ff6600;
    }
  </style>
</head>
<body>
  <h1>Meine Toolbox Deluxe</h1>

  <div class="drop-zone" id="dropZone">HTML-Dateien hierher ziehen, um sie als Tools zu speichern</div>

  <h2>HTML-Bausteine</h2>
  <select id="snippetSelect">
    <option value="">Baustein wählen...</option>
    <option value="<button>Klick mich</button>">&lt;button&gt; Klick mich</option>
    <option value="<input type='text' placeholder='Dein Text'>">&lt;input&gt; Textfeld</option>
    <option value="<img src='https://via.placeholder.com/150'>">&lt;img&gt; Platzhalterbild</option>
    <option value="<button onclick='alert(&quot;Hallo!&quot;)'>Sag Hallo</button>">JS-Alert-Button</option>
  </select>
  <button onclick="insertSnippet()">In Codefeld einfügen</button>

  
<h2>GPT-Code Generator (optional mit API)</h2>
<input type="password" id="apiKey" placeholder="OpenAI API-Key (optional)" />

  <input type="text" id="manualPrompt" placeholder="Beschreibe dein Tool z. B. 'Ein Button der Uhrzeit zeigt'" />
  <button onclick="simulateGPT()">HTML simulieren</button>

  <h2>Tool erstellen</h2>
  <input type="text" id="toolName" placeholder="Name für neues Tool" />
  <textarea id="toolCode" rows="10" placeholder="HTML-Code für neues Tool einfügen..."></textarea>
  <button onclick="addTool()">Tool hinzufügen</button>
  <button onclick="exportAll()">Toolbox als Datei exportieren</button>

  <h2>Gespeicherte Tools</h2>
  <ul id="toolList"></ul>

  <h2>Vorschau</h2>
  <iframe id="preview"></iframe>

  <script>
    const tools = {
      "Zufallszahl": "<button onclick='alert(Math.floor(Math.random()*100))'>Zufallszahl anzeigen</button>",
      "Monero QR Placeholder": "<p>Monero QR-Code Generator kommt hier hin</p>",
      "Farbwechsel": "<button onclick='document.body.style.backgroundColor = `#${Math.floor(Math.random()*16777215).toString(16)}`'>Hintergrund ändern</button>"
    };

    function renderList() {
      const list = document.getElementById("toolList");
      list.innerHTML = "";
      Object.keys(tools).forEach(name => {
        const li = document.createElement("li");
        li.textContent = name;
        li.ondblclick = () => runTool(name);
        list.appendChild(li);
      });
    }

    function runTool(name) {
      const iframe = document.getElementById("preview");
      const doc = iframe.contentDocument || iframe.contentWindow.document;
      doc.open();
      doc.write(tools[name]);
      doc.close();
    }

    function addTool() {
      const name = document.getElementById("toolName").value.trim();
      const code = document.getElementById("toolCode").value.trim();
      if (!name || !code) return alert("Name und Code sind erforderlich.");
      tools[name] = code;
      renderList();
      document.getElementById("toolName").value = "";
      document.getElementById("toolCode").value = "";
    }

    function exportAll() {
      const content = `
<!DOCTYPE html>
<html><body><pre>${JSON.stringify(tools, null, 2)}</pre></body></html>`;
      const blob = new Blob([content], {type: "text/html"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "toolbox_export.html";
      a.click();
    }

    function insertSnippet() {
      const val = document.getElementById("snippetSelect").value;
      if (!val) return;
      const textarea = document.getElementById("toolCode");
      textarea.value += "\n" + val;
    }

    
async function simulateGPT() {
  const prompt = document.getElementById("manualPrompt").value;
  const apiKey = document.getElementById("apiKey").value.trim();

  if (!apiKey) {
    // Offline Simulation
    const lower = prompt.toLowerCase();
    let generated = "<p>(Kein gültiger Vorschlag erkannt.)</p>";
    if (lower.includes("uhrzeit")) {
      generated = "<button onclick='alert(new Date().toLocaleTimeString())'>Zeige Uhrzeit</button>";
    } else if (lower.includes("farbe")) {
      generated = "<button onclick='document.body.style.backgroundColor = `#${Math.floor(Math.random()*16777215).toString(16)}`'>Farbe ändern</button>";
    } else if (lower.includes("bild")) {
      generated = "<img src='https://via.placeholder.com/200'>";
    }
    document.getElementById("toolCode").value = generated;
    return;
  }

  // Echte GPT-Antwort via OpenAI API
  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + apiKey
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [{ role: "user", content: prompt }],
        temperature: 0.4
      })
    });
    const data = await res.json();
    const content = data.choices?.[0]?.message?.content || "Keine Antwort.";
    document.getElementById("toolCode").value = content;
  } catch (err) {
    document.getElementById("toolCode").value = "Fehler: " + err.message;
  }
}

      const prompt = document.getElementById("manualPrompt").value.toLowerCase();
      let generated = "<p>(Kein gültiger Vorschlag erkannt.)</p>";
      if (prompt.includes("uhrzeit")) {
        generated = "<button onclick='alert(new Date().toLocaleTimeString())'>Zeige Uhrzeit</button>";
      } else if (prompt.includes("farbe")) {
        generated = "<button onclick='document.body.style.backgroundColor = `#${Math.floor(Math.random()*16777215).toString(16)}`'>Farbe ändern</button>";
      } else if (prompt.includes("bild")) {
        generated = "<img src='https://via.placeholder.com/200'>";
      }
      document.getElementById("toolCode").value = generated;
    }

    const dropZone = document.getElementById("dropZone");
    dropZone.addEventListener("dragover", e => {
      e.preventDefault();
      dropZone.classList.add("dragover");
    });
    dropZone.addEventListener("dragleave", () => dropZone.classList.remove("dragover"));
    dropZone.addEventListener("drop", e => {
      e.preventDefault();
      dropZone.classList.remove("dragover");
      const file = e.dataTransfer.files[0];
      if (file && file.name.endsWith(".html")) {
        const reader = new FileReader();
        reader.onload = () => {
          const name = file.name.replace(/\.html$/i, "");
          tools[name] = reader.result;
          renderList();
          alert(`Tool "${name}" hinzugefügt.`);
        };
        reader.readAsText(file);
      }
    });

    renderList();
  </script>
</body>
</html>
